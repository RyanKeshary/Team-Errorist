<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CrisisMitra | Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="icon" href="./Material/logo.png" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
        background-color: #0a0a0a;
        color: #ffffff;
      }
      .card {
        background-color: #1a1a1a;
        border: 1px solid #333333;
        transition: all 0.3s ease;
      }
      .card:hover {
        border-color: white;
        transform: translateY(-5px);
      }
      .stat-card {
        background: linear-gradient(135deg, #1a1a1a 0%, #333333 100%);
      }
      #map {
        height: 400px;
        width: 100%;
        border-radius: 10px;
        z-index: 1;
      }
      .leaflet-popup-content-wrapper {
        background-color: #1a1a1a;
        color: #fff;
      }
      .leaflet-popup-tip {
        background-color: #1a1a1a;
      }
      .leaflet-control-attribution {
        display: none;
      }
      .btn-clear {
        background: #dc2626;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        transition: 0.2s;
      }
      .btn-clear:hover {
        background: #b91c1c;
      }

      /* Collapsible Language Switch */
      #lang-switch {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 50;
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(10, 10, 10, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid #333;
        border-radius: 9999px;
        padding: 6px 10px;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        cursor: pointer;
        transition: all 0.3s ease-in-out;
      }
      #lang-switch.collapsed #lang-buttons {
        opacity: 0;
        width: 0;
        overflow: hidden;
        pointer-events: none;
      }
      #lang-switch:hover #lang-buttons {
        opacity: 1;
        width: auto;
        pointer-events: auto;
      }
    </style>
  </head>

  <body class="min-h-screen bg-[#0A0A0A]">
    <!-- Language Switch -->
    <div id="lang-switch">
      <i data-feather="globe" class="w-5 h-5 text-white"></i>
      <div id="lang-buttons" class="flex gap-2 transition-all duration-300">
        <button
          id="lang-en"
          class="px-3 py-1 bg-white text-black rounded-full text-sm font-medium hover:scale-105 transition"
        >
          EN
        </button>
        <button
          id="lang-hi"
          class="px-3 py-1 bg-white text-black rounded-full text-sm font-medium hover:scale-105 transition"
        >
          à¤¹à¤¿
        </button>
        <button
          id="lang-mr"
          class="px-3 py-1 bg-white text-black rounded-full text-sm font-medium hover:scale-105 transition"
        >
          à¤®
        </button>
      </div>
    </div>

    <!-- Header -->
    <header class="px-4 py-6 border-b border-[#333333]">
      <div class="max-w-6xl mx-auto flex justify-between items-center">
        <a href="index.html" class="text-2xl font-medium">CrisisMitra</a>
        <div class="flex items-center gap-3">
          <!-- Volunteer Login -->
          <a
            href="login.html"
            class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm flex items-center gap-2 hover:bg-blue-700 transition"
          >
            <i data-feather="user" class="w-4 h-4"></i>
            <span data-i18n="volunteerLogin">Volunteer Login</span>
          </a>

          <!-- SOS -->
          <a
            href="sos.html"
            class="bg-red-600 text-white px-4 py-2 rounded-full text-sm flex items-center gap-2 hover:bg-red-700 transition"
          >
            <i data-feather="alert-triangle" class="w-4 h-4"></i>
            <span data-i18n="sosBtn">SOS</span>
          </a>
        </div>
      </div>
    </header>

    <!-- Dashboard Content -->
    <main class="max-w-6xl mx-auto px-4 py-8">
      <h1 data-i18n="responseDashboard" class="text-3xl font-medium mb-8">
        Response Dashboard
      </h1>

      <!-- Stats -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="stat-card p-6 rounded-xl">
          <div class="flex items-center justify-between">
            <div>
              <p data-i18n="activeAlerts" class="text-[#D3D3D3] text-sm">
                Active Alerts
              </p>
              <p class="text-3xl font-bold">24</p>
            </div>
            <div
              class="w-12 h-12 bg-red-600/20 rounded-full flex items-center justify-center"
            >
              <i data-feather="alert-circle" class="text-red-500"></i>
            </div>
          </div>
        </div>

        <div class="stat-card p-6 rounded-xl">
          <div class="flex items-center justify-between">
            <div>
              <p data-i18n="responders" class="text-[#D3D3D3] text-sm">
                Responders
              </p>
              <p class="text-3xl font-bold">128</p>
            </div>
            <div
              class="w-12 h-12 bg-blue-600/20 rounded-full flex items-center justify-center"
            >
              <i data-feather="users" class="text-blue-500"></i>
            </div>
          </div>
        </div>

        <div class="stat-card p-6 rounded-xl">
          <div class="flex items-center justify-between">
            <div>
              <p data-i18n="resolvedToday" class="text-[#D3D3D3] text-sm">
                Resolved Today
              </p>
              <p class="text-3xl font-bold">42</p>
            </div>
            <div
              class="w-12 h-12 bg-green-600/20 rounded-full flex items-center justify-center"
            >
              <i data-feather="check-circle" class="text-green-500"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Map -->
      <div class="mb-8">
        <h2 data-i18n="mapTitle" class="text-xl font-medium mb-4">
          Interactive Incident Map
        </h2>
        <div class="card rounded-lg overflow-hidden p-4">
          <div id="map"></div>
          <div class="flex justify-end mt-4">
            <button
              id="clearMarkers"
              class="btn-clear flex items-center gap-2 text-sm"
            >
              ðŸ—‘ <span data-i18n="clearMarkers">Clear All Markers</span>
            </button>
          </div>
        </div>
      </div>
    </main>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      feather.replace();

      // Scroll collapse for language switch
      let lastScroll = 0;
      window.addEventListener("scroll", () => {
        const langSwitch = document.getElementById("lang-switch");
        const currentScroll = window.scrollY;
        if (currentScroll > lastScroll && currentScroll > 100) {
          langSwitch.classList.add("collapsed");
        } else {
          langSwitch.classList.remove("collapsed");
        }
        lastScroll = currentScroll;
      });

      // Map
      const map = L.map("map").setView([20.5937, 78.9629], 5);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 18,
        attribution: "&copy; OpenStreetMap contributors",
      }).addTo(map);

      let sosMarkers = JSON.parse(localStorage.getItem("sosMarkers")) || [];
      sosMarkers.forEach((marker) => {
        L.marker([marker.lat, marker.lng])
          .addTo(map)
          .bindPopup(`<b>${marker.title}</b><br>${marker.description}`);
      });

      map.on("click", function (e) {
        const title = prompt("Enter SOS Title (e.g. 'Flood Help Needed')");
        const description = prompt(
          "Enter short description (e.g. '3 people stranded near river')"
        );
        if (!title || !description) return;
        const newMarker = {
          lat: e.latlng.lat,
          lng: e.latlng.lng,
          title,
          description,
        };
        L.marker([newMarker.lat, newMarker.lng])
          .addTo(map)
          .bindPopup(`<b>${title}</b><br>${description}`)
          .openPopup();
        sosMarkers.push(newMarker);
        localStorage.setItem("sosMarkers", JSON.stringify(sosMarkers));
      });

      document.getElementById("clearMarkers").addEventListener("click", () => {
        if (confirm("Are you sure you want to clear all SOS markers?")) {
          localStorage.removeItem("sosMarkers");
          location.reload();
        }
      });

      // Translations
      const translations = {
        en: {
          sosBtn: "SOS",
          volunteerLogin: "Volunteer Login",
          responseDashboard: "Response Dashboard",
          activeAlerts: "Active Alerts",
          responders: "Responders",
          resolvedToday: "Resolved Today",
          mapTitle: "Interactive Incident Map",
          clearMarkers: "Clear All Markers",
        },
        hi: {
          sosBtn: "à¤à¤¸à¤“à¤à¤¸",
          volunteerLogin: "à¤¸à¥à¤µà¤¯à¤‚à¤¸à¥‡à¤µà¤• à¤²à¥‰à¤—à¤¿à¤¨",
          responseDashboard: "à¤ªà¥à¤°à¤¤à¤¿à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡",
          activeAlerts: "à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤…à¤²à¤°à¥à¤Ÿ",
          responders: "à¤‰à¤¤à¥à¤¤à¤°à¤¦à¤¾à¤¤à¤¾",
          resolvedToday: "à¤†à¤œ à¤¹à¤² à¤•à¤¿à¤ à¤—à¤",
          mapTitle: "à¤‡à¤‚à¤Ÿà¤°à¤à¤•à¥à¤Ÿà¤¿à¤µ à¤˜à¤Ÿà¤¨à¤¾ à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤°",
          clearMarkers: "à¤¸à¤­à¥€ à¤®à¤¾à¤°à¥à¤•à¤° à¤¹à¤Ÿà¤¾à¤à¤‚",
        },
        mr: {
          sosBtn: "à¤à¤¸à¤“à¤à¤¸",
          volunteerLogin: "à¤¸à¥à¤µà¤¯à¤‚à¤¸à¥‡à¤µà¤• à¤²à¥‰à¤—à¤¿à¤¨",
          responseDashboard: "à¤ªà¥à¤°à¤¤à¤¿à¤¸à¤¾à¤¦ à¤¡à¥…à¤¶à¤¬à¥‹à¤°à¥à¤¡",
          activeAlerts: "à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤šà¥‡à¤¤à¤¾à¤µà¤£à¥€",
          responders: "à¤ªà¥à¤°à¤¤à¤¿à¤¸à¤¾à¤¦à¤•à¤°à¥à¤¤à¥‡",
          resolvedToday: "à¤†à¤œ à¤¨à¤¿à¤°à¤¾à¤•à¤°à¤£ à¤à¤¾à¤²à¥‡à¤²à¥‡",
          mapTitle: "à¤ªà¤°à¤¸à¥à¤ªà¤°à¤¸à¤‚à¤µà¤¾à¤¦à¥€ à¤˜à¤Ÿà¤¨à¤¾ à¤¨à¤•à¤¾à¤¶à¤¾",
          clearMarkers: "à¤¸à¤°à¥à¤µ à¤®à¤¾à¤°à¥à¤•à¤° à¤¸à¤¾à¤« à¤•à¤°à¤¾",
        },
      };

      function setLanguage(lang) {
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          const key = el.getAttribute("data-i18n");
          el.textContent = translations[lang][key] || key;
        });
      }

      document
        .getElementById("lang-en")
        .addEventListener("click", () => setLanguage("en"));
      document
        .getElementById("lang-hi")
        .addEventListener("click", () => setLanguage("hi"));
      document
        .getElementById("lang-mr")
        .addEventListener("click", () => setLanguage("mr"));
    </script>
  </body>
</html>
